
remove_modes -all
remove_corners -all
remove_scenarios -all
reset_timing_derate -corners [all_corners]
remove_sdc
#Variable settings
#set sdc_path    /home/projects/vlsi/Research/REF_METHODOLOGY/REFERENCE_METHODOLOGY/SYNOPSYS/ICC2/front_end
set sdc_path    ../../front_end
set modes 	"BIGDIV_5GHz"
set rc_corners  "FuncCmax FuncCmaxDP FuncCmin FuncCminDP FuncRCmax FuncRCmaxDP FuncRCmin FuncRCminDP nominal"
set pvt_corners "ssg0p72vm40c tt0p80v25c ffg0p88v125c"

#Setting up dictionary for pvt_corner and related rc_corners

set rc_pvt_dict [dict create ssg0p72vm40c "FuncCmax FuncRCmax" \
		      tt0p80v25c		  "nominal" \
		      ffg0p88v125c        "FuncCmin FuncRCmin" \
	        ]

set pvt_dict    [dict create	ssg0p72vm40c \
					 "process 1.0 \
					  voltage 0.72 \
					  temperature -40 \
					  op_lib_pairs \
						{{SSG_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_BASE_CSC20L_SSG_0P72V_0P00V_0P00V_0P00V_M40C} {SSG_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_BASE_CSC20SL_SSG_0P72V_0P00V_0P00V_0P00V_M40C} {SSG_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_BASE_CSC24L_SSG_0P72V_0P00V_0P00V_0P00V_M40C} {SSG_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_BASE_CSC28L_SSG_0P72V_0P00V_0P00V_0P00V_M40C} {SSG_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_BASE_CSC24SL_SSG_0P72V_0P00V_0P00V_0P00V_M40C} {SSG_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_BASE_CSC28SL_SSG_0P72V_0P00V_0P00V_0P00V_M40C} {IN22FDX_GPIO18_10M19S20PS_SSG_0P72_1P08_M40 IN22FDX_GPIO18_10M19S20PS_SSG_0P72_1P08_M40} {SSG_0P720V_0P000V_0P000V_M40C IN22FDX_R1PH_NFHN_W00256B046M02C256_104cpp_SSG_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P000V_0P000V_M40C IN22FDX_R1PH_NFHN_W00256B128M02C256_104cpp_SSG_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C  IN22FDX_S1D_NFRG_W04096B032M04C128_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_NFRG_W02048B032M04C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P000V_0P000V_M40C IN22FDX_R1PH_NFHN_W01024B032M04C256_104cpp_SSG_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_NFRG_W02048B032M04C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_NFRG_W02048B032M04C128_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_NFRG_W02048B032M04C128_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_BFRG_W32768B039M16C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_BFRG_W08192B076M04C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_BFRG_W02560B076M04C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P72V_0P72V_0P00V_0P00V_0P00V_M40C GF22FDX_SC8T_104CPP_SHIFT_CSL_SSG_0P72V_0P72V_0P00V_0P00V_0P00V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_BFRG_W04096B076M04C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_S1D_BFRG_W08192B039M16C256_104cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P720V_0P000V_0P000V_M40C IN22FDX_R2PV_WFVG_W00512B032M04C128_116cpp_SSG_0P720V_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P000V_0P000V_M40C IN22FDX_R1PH_NFHN_W00128B064M04C256_104cpp_SSG_0P720V_0P000V_0P000V_M40C} {SSG_0P720V_0P000V_0P000V_M40C IN22FDX_R1PH_NFHN_W00512B064M02C256_104cpp_SSG_0P720V_0P000V_0P000V_M40C}} \
					  max_trans 0.6 \
					  cell_derate_early 0.88 \
					  net_derate_early  0.88 \
					  cell_derate_late  1.112 \
					  net_derate_late  1.112 \
					  is_setup true \
					  is_leakage true \
					  is_hold false \
     					  is_dynamic_power true" \
				tt0p80v25c   \
					 "process 1.0 \
					  voltage 0.80 \
					  temperature 25 \
					  op_lib_pairs \
						{{TT_0P80V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_BASE_CSC20L_TT_0P80V_0P00V_0P00V_0P00V_25C} {TT_0P80V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_BASE_CSC20SL_TT_0P80V_0P00V_0P00V_0P00V_25C} {TT_0P80V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_BASE_CSC24L_TT_0P80V_0P00V_0P00V_0P00V_25C} {TT_0P80V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_BASE_CSC28L_TT_0P80V_0P00V_0P00V_0P00V_25C} {TT_0P80V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_BASE_CSC24SL_TT_0P80V_0P00V_0P00V_0P00V_25C} {TT_0P80V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_BASE_CSC28SL_TT_0P80V_0P00V_0P00V_0P00V_25C} {IN22FDX_GPIO18_10M19S20PS_TT_0P8_1P8_25 IN22FDX_GPIO18_10M19S20PS_TT_0P8_1P8_25} {TT_0P800V_0P000V_0P000V_025C  IN22FDX_R1PH_NFHN_W00256B128M02C256_104cpp_TT_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P000V_0P000V_025C IN22FDX_R1PH_NFHN_W00256B046M02C256_104cpp_TT_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C  IN22FDX_S1D_NFRG_W04096B032M04C128_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C  IN22FDX_S1D_NFRG_W02048B032M04C256_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_NFRG_W02048B032M04C128_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_NFRG_W02048B032M04C128_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_BFRG_W32768B039M16C256_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_BFRG_W08192B076M04C256_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_BFRG_W02560B076M04C256_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P90V_0P90V_0P00V_0P00V_0P00V_25C GF22FDX_SC8T_104CPP_SHIFT_CSL_TT_0P90V_0P90V_0P00V_0P00V_0P00V_25C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_BFRG_W04096B076M04C256_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_S1D_BFRG_W08192B039M16C256_104cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P800V_0P000V_0P000V_025C IN22FDX_R2PV_WFVG_W00512B032M04C128_116cpp_TT_0P800V_0P800V_0P000V_0P000V_025C} {SSG_0P800V_0P000V_0P000V_025C IN22FDX_R1PH_NFHN_W00128B064M04C256_104cpp_SSG_0P800V_0P000V_0P000V_025C} {TT_0P800V_0P000V_0P000V_025C IN22FDX_R1PH_NFHN_W00512B064M02C256_104cpp_TT_0P800V_0P000V_0P000V_025C}} \
					  max_trans 0.4 \
					  cell_derate_early 0.88 \
					  net_derate_early  0.88 \
					  cell_derate_late  1.112 \
					  net_derate_late  1.112 \
					  is_setup true \
					  is_leakage true \
					  is_hold false \
     					  is_dynamic_power false" \
				ffg0p88v125c \
					 "process 1.0 \
					  voltage 0.88 \
					  temperature 125 \
					  op_lib_pairs \
						{{FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC20L_FFG_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC20SL_FFG_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC24L_FFG_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC24L_FFG_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC28L_FFG_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC24SL_FFG_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_BASE_CSC28SL_FFG_0P88V_0P00V_0P00V_0P00V_125C} {IN22FDX_GPIO18_10M19S20PS_FFG_0P88_1P98_125 IN22FDX_GPIO18_10M19S20PS_FFG_0P88_1P98_125} {FFG_0P880V_0P000V_0P000V_125C IN22FDX_R1PH_NFHN_W00256B046M02C256_104cpp_FFG_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P000V_0P000V_125C  IN22FDX_R1PH_NFHN_W00256B128M02C256_104cpp_FFG_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C  IN22FDX_S1D_NFRG_W04096B032M04C128_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C  IN22FDX_S1D_NFRG_W02048B032M04C256_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_NFRG_W02048B032M04C128_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_NFRG_W02048B032M04C128_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_BFRG_W32768B039M16C256_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_BFRG_W08192B076M04C256_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_BFRG_W02560B076M04C256_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P88V_0P88V_0P00V_0P00V_0P00V_125C GF22FDX_SC8T_104CPP_SHIFT_CSL_FFG_0P88V_0P88V_0P00V_0P00V_0P00V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_BFRG_W04096B076M04C256_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_S1D_BFRG_W08192B039M16C256_104cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P880V_0P000V_0P000V_125C IN22FDX_R2PV_WFVG_W00512B032M04C128_116cpp_FFG_0P880V_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P000V_0P000V_125C IN22FDX_R1PH_NFHN_W00128B064M04C256_104cpp_FFG_0P880V_0P000V_0P000V_125C} {FFG_0P880V_0P000V_0P000V_125C IN22FDX_R1PH_NFHN_W00512B064M02C256_104cpp_FFG_0P880V_0P000V_0P000V_125C}} \
					  max_trans 0.4 \
					  cell_derate_early 0.88 \
					  net_derate_early  0.88 \
					  cell_derate_late  1.112 \
					  net_derate_late  1.112 \
					  is_setup true \
					  is_leakage true \
					  is_hold true \
     					  is_dynamic_power false" \
	]

puts "Starting with the modes"
foreach mode $modes {
	create_mode $mode
	puts "Working on mode $mode"
	foreach pvt_corner $pvt_corners {
		puts "Working on pvt corner $pvt_corner"
		set pvt_rc_corners [dict get $rc_pvt_dict $pvt_corner ]
		foreach pvt_rc_corner $pvt_rc_corners {
			puts "Working on rc corner $pvt_rc_corner"
			set corner_name ${pvt_corner}_${pvt_rc_corner}
			set scenario_name ${mode}::${corner_name}
			##If you have more modes, probably we need to check if the corner already exists before creating
			create_corner $corner_name
			create_scenario -name $scenario_name -mode $mode -corner $corner_name
			puts "Done with scenario creation"

			set process_num   	[dict get $pvt_dict $pvt_corner process 	  ]
			set max_trans   	[dict get $pvt_dict $pvt_corner max_trans         ]
			set voltage     	[dict get $pvt_dict $pvt_corner voltage           ]
			set temperature 	[dict get $pvt_dict $pvt_corner temperature       ]
			set cell_derate_early   [dict get $pvt_dict $pvt_corner cell_derate_early ]
			set cell_derate_late    [dict get $pvt_dict $pvt_corner cell_derate_late  ]
			set net_derate_early    [dict get $pvt_dict $pvt_corner net_derate_early  ]
			set net_derate_late     [dict get $pvt_dict $pvt_corner net_derate_late   ]
			set op_lib_pairs	[dict get $pvt_dict $pvt_corner op_lib_pairs	  ]
			set is_setup 		[dict get $pvt_dict $pvt_corner is_setup 	  ]
			set is_hold 		[dict get $pvt_dict $pvt_corner is_hold 	  ]
			set is_setup 		[dict get $pvt_dict $pvt_corner is_setup 	  ]
			set is_leakage 		[dict get $pvt_dict $pvt_corner is_leakage 	  ]
			set is_dynamic_power	[dict get $pvt_dict $pvt_corner is_dynamic_power  ]
			

			current_scenario $scenario_name
			source ${sdc_path}/${mode}.sdc
			set_parasitic_parameters -early_spec $pvt_rc_corner -late_spec ${pvt_rc_corner}
			#set_max_transition $max_trans [current_design]

			foreach op_lib_pair $op_lib_pairs {
				set op  [lindex $op_lib_pair 0]
				set lib [lindex $op_lib_pair 1]

				set_operating_conditions -analysis_type on_chip_variation $op -library $lib
			}
			puts "Process : $process_num, Voltage : $voltage, Temperature : $temperature"	
			set_process_number $process_num
			set_voltage 	   $voltage -object_list [get_object_name [get_flat_nets -all -filter "net_type==power"]] -corner $corner_name
			set_temperature    $temperature
			set_timing_derate -cell_delay $cell_derate_late -late 
			set_timing_derate -cell_delay $cell_derate_early -early 
			set_timing_derate -net_delay  $net_derate_late -late 
			set_timing_derate -net_delay  $net_derate_early -early 
		
			set_scenario_status $scenario_name -none -setup $is_setup -hold $is_hold -leakage_power $is_leakage -dynamic_power $is_dynamic_power -max_transition true -max_capacitance true -min_capacitance true -active true	
		}	
	}
}
